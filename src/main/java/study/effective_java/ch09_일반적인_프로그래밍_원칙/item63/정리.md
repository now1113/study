:trophy: 이펙티브 자바 스터디 - 아이템 63

:book: 아이템 63: 문자열 연결은 느리니 주의하라

## 문자열 연결은 왜 느릴까
- **문자열(String)은 불변**이라, `s = s + x`할 때 마다 **새로운 String을 만들며 기존 내용 전체를 복사**한다.
- 루프에서 `n`번 반복하면 **복사량이 누적**되어 **총 시간은 대략 $O(n^2)$으로 커진다.**
- 반면 `StringBuilder`**는 가변 버퍼**로 동작해 **append가 $O(1)$(평균)에 가깝다.** 필요한 경우에만 내부 버퍼가 확장된다.

## 최적화 사실
- **한 줄짜리 연결식(`"a=" + a + ", b=" + b`)은 컴파일러가 내부적으로** `StringBuilder().append(...).append(..).toString()` 으로 바꿔준다.
  - 따라서 **한 번의 표현식에서 몇 개만 잇는건 `+` 사용해도 괜찮다** (가독성 측면에서도 무난하다.)
- 하지만 **루프 안에서** `s += ...`을 쓰면 **매 반복마다 새로운 String이 생성**되므로 최악이다. 이때는 `StringBuilder`를 써야한다.

## 잘못 사용 예 (루프에서 +)
```java
public class BadConcatExample {
    public static String repeatCharWithPlus(char ch, int n) {
        String s = "";
        for (int i = 0; i < n; i++) {
            s = s + ch;
        }
        return s;
    }
}
```

## 올바른 사용 예 (StringBuilder)

```java
public class GoodConcatExample {
    public static String repeatCharWithBuilder(char ch, int n) {
        StringBuilder sb = new StringBuilder(n);
        for (int i = 0; i < n; i++) {
            sb.append(ch);
        }
        return sb.toString();
    }
}
```

## 컬렉션을 이어붙일 때
- 이미 **문자열 리스트**가 있다면 `String joined = String.join(",", list);`
- 스트림이라면 `String joined = list.stream().collect(Collectors.joining(","));`

## 핵심 정리
- **루프 안에서 `+`로 문자열을 누적하지 말자.** -> `StringBuilder.append` 사용하자.
- **최종 길이를 대략 알면** `new StringBuilder(예상길이)`**로 capacity 지정**해 재할당을 줄이자.
- **한 줄짜리 연결식**은 `+`를 써도 괜찮다(컴파일러가 `StringBuilder`로 바꿔준다)
- `String.format`은 가독성은 좋지만 **상대적으로 느리다** (포맷 파싱/로케일 고려). 성능 민감 경로에선 피하자.
- 멀티스레드가 아니라면 `StringBuffer` **대신** `StringBuilder`.