:trophy: 이펙티브 자바 스터디 - 아이템 54

:book: 아이템 54: null이 아닌, 빈 컬렉션이나 배열을 반환하라

## 핵심
- 메서드 **원소가 없을 수 있는 결과**를 반환해야 할 때 `null`을 **반환하지 말고 빈 컬렉션/배열을 반환**하라.
- 이유
  - **호출 코드 단순화**: 매번 null 방어 코드가 필요 없어짐
  - **버그 예방**: `for-each`, `stream()` 등에서 NPE 방지
  - **성능상 불이익 거의 없음**: 빈 컨테이너는 가볍고 재사용이 가능하다.


## 잘못된 예
```java
public class Refrigerator {
    
    private List<Cheese> cheeses;
    
    public List<Cheese> getCheeses() {
        if (cheeses.isEmpty()) {
            return null;
        }
        return new ArrayList<>(cheeses);
    }
}
```
다음과 같이 `없음`을 null로 표현했을 때 호출자는 아래와 같이 번잡해진다.

```java
public class Shop {
    
    private Refrigerator refrigerator;

    public void buyCheese() {
        List<Cheese> cheeses = refrigerator.getCheeses();
        
        if (cheeses != null & !cheeses.isEmpty()) {
            // 이후 로직 진행
        }
    }
}
```

## 권장 예 - 컬렉션
```java
public class Refrigerator {
    
    private List<Cheese> cheeses;
    
    public List<Cheese> getCheeses() {
        if (cheeses.isEmpty()) {
            return Collections.emptyList();
        }
        return List.copyOf(cheeses);
    }
}
```
- `Collections.emptyList()/emptySet()/emptyMap()`은 **불변 + 싱글턴**이라 매우 가볍다.

호출부는 그냥 사용하면 된다.

```java
public class Shop {
    
    private Refrigerator refrigerator;

    public void buyCheese() {
        List<Cheese> cheeses = refrigerator.getCheeses();
        for (Cheese cheese : cheeses) {
            // 로직 진행
        }
    }
}
```

## 권장 예 - 배열
```java
public class Refrigerator {

    private List<Cheese> cheeses;

    public Cheese[] getCheeseArray() {
        if (cheeses.isEmpty()) {
            return new Cheese[0];
        }
        return cheeses.toArray(new Cheese[0]);
    }
}
```
- 길이 0 배열은 할당 비용이 매우 작다. 필요하다면 아래처럼 **재사용 상수**를 둬도 됨

```java
private static final Cheese[] EMPTY_CHEESE_ARRAY = new Cheese[0];

public Cheese[] getCheeseArray() {
    return cheeses.isEmpty() ? EMPTY_CHEESE_ARRAY : cheeses.toArray(new Cheese[0]);
}
```

## Optional과의 관계
- **원소가 0개 이상인 반환(컬렉션/배열)에 `Optional<Collection>`을 쓰지 말자**
- **그냥 빈 컬렉션/배열**이 `없음`을 충분히 표현한다.

## 요약
- **없으면 null 대신 빈 컨테이너를 돌려라.**
- 호출부는 간단해지고 NPE가 사라진다.
- 컬렉션: `Collections.emptyXxx()` 또는 `Xxx.of()`
- 배열: `new T[0]` 또는 재사용 상수 + `toArray(new T[0])` 관용구.